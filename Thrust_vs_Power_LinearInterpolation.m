clc;
clear;

% Given data
Thrust = [0.84, 2.6, 4.9, 7.9745, 10.537, 12.875, 15.499, 18.099, 20.583, 22.963, 24.907, 28.679, ...
    33.223, 38.229, 43.609, 48.982, 53.939, 59.36, 64.97, 70.822, 77, 83.4, 90.07, 97.13, 104.42, 102.95, ...
    127.21, 135.34, 143.71, 152.37, 161.31, 170.54, 180.05, 189.85, 199.97, 210.38, 221.08, 232.08, ...
    243.37, 254.946, 266.841, 279.028, 291.483, 304.281, 317.393, 330.814, 344.554, 358.619, 372.955];

Power = [0.03914943079, 0.812597429, 4.513699079, 16.7425115, 38.71540781, 73.50219272, 130.3678291, 214.498868, ...
    331.9609887, 490.7418917, 688.8703856, 1015.39608, 1485.233427, 2126.525119, 2973.873524, 4032.3036, ...
    5281.213993, 6877.99308, 8823.442499, 11188.42187, 14052.91847, 17467.90161, 21519.38466, 26349.67178, ...
    32013.32021, 32822.37221, 54588.02462, 64459.29045, 75711.27986, 88495.64448, 102964.288, ...
    119309.2727, 137675.5361, 158283.594, 181103.3503, 207048.7594, 235617.3942, 267312.8326, 302371.3257, ...
    341040.1106, 383644.8579, 430460.8682, 481735.9737, 537928.7081, 599347.4307, 666327.8614, 739274.8415, ...
    818608.4645, 904575.4498];

% Removing duplicate thrust values
[Thrust, uniqueIdx] = unique(Thrust, 'stable');
Power = Power(uniqueIdx);

% Thrust values to predict
New_Thrust = [4.8215, 7.8167, 13.731, 21.784, 36.625, 61.418, 71.868, 77.935, 114.75, 159.83, 182.72, ...
    185.45, 194.18, 215.12, 266.79, 303.01, 329.72, 356.43, 387.17, 421.65, 458.65, 497.96, 539.66, 583.53, ...
    629.48, 677.53, 727.51, 779.52, 833.62, 889.65, 947.62, 1007.5, 1069.3, 1132.9, 1198.4, 1265.7, 1334.9, ...
    1405.9, 1488.8, 1553.6];

% Plotting the original data
figure;
plot(Thrust, Power, '-o', 'LineWidth', 1.5);
grid on;
xlabel('Thrust (N)');
ylabel('Power (W)');
title('Thrust vs Power Plot with Linear Interpolation');

% Linear Interpolation for new thrust values
Predicted_Power = interp1(Thrust, Power, New_Thrust, 'linear');

% Displaying predicted values
fprintf('Predicted Power Values:\n');
for i = 1:length(New_Thrust)
    fprintf('Thrust: %.4f N -> Predicted Power: %.4f W\n', New_Thrust(i), Predicted_Power(i));
end
